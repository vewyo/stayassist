flows:
  greet:
    description: Welcome guests and ask how the assistant can help them.
    steps:
      - action: utter_greet_and_offer_help
  book_room:
    description: Collect all information required to create a room reservation.
    steps:
      - id: ask_arrival_date
        collect: arrival_date
        description: "ask for the desired arrival date, handle typos and invalid dates gracefully"
      - action: action_validate_date
      - id: check_date_valid
        next:
          - if: slots.arrival_date is null
            then: ask_arrival_date
          - else: ask_nights
      - id: ask_nights
        collect: nights
        description: "ask for the number of nights, convert words to numbers, handle invalid numbers"
      - action: action_validate_nights
      - id: check_nights_valid
        next:
          - if: slots.nights is null
            then: ask_nights
          - else: ask_rooms
      - id: ask_rooms
        collect: rooms
        description: "ask for the number of rooms, convert words to numbers, handle invalid numbers"
      - action: action_validate_rooms
      - id: check_rooms_valid
        next:
          - if: slots.rooms is null
            then: ask_rooms
          - else: ask_guests
      - id: ask_guests
        collect: guests
        description: "ask for the number of guests, convert words to numbers, handle invalid numbers"
      - action: action_validate_guests
      - id: check_guests_valid
        next:
          - if: slots.guests is null
            then: ask_guests
          - else: ask_payment
      - id: ask_payment
        collect: payment_option
        description: "ask whether the guest wants to pay at the desk or online"
  book_room_pay_at_desk:
    description: Handle bookings when the guest prefers to pay at the front desk.
    steps:
      - collect: email
        description: "ask for the guest's email address"
      - collect: first_name
        description: "ask for the guest's first name"
      - collect: last_name
        description: "ask for the guest's last name"
      - action: action_confirm_reservation_hold
      - action: action_generate_booking_number
  book_room_pay_online:
    description: Handle bookings where the guest chooses to pay online.
    steps:
      - action: action_send_payment_link
      - collect: payment_confirmation
        description: "wait until the guest confirms that payment was made"
      - action: action_confirm_payment_received
      - action: action_generate_booking_number
  cancel_booking:
    description: Allow guests to cancel an existing reservation when they provide the booking number.
    steps:
      - collect: booking_number
        description: "ask for the booking number the guest wants to cancel"
      - action: action_cancel_booking
  facility_information:
    description: Provide fixed information about on-site facilities such as pool hours, parking, and meals.
    steps:
      - collect: facility_topic
        description: "ask which facility the guest needs information about (pool, parking, breakfast, lunch, dinner, gym)"
      - action: action_answer_facility_question
  clarification:
    description: Provide simpler, step-by-step explanation when guest doesn't understand.
    steps:
      - action: action_clarify_explanation
